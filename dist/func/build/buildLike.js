"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.buildLike=f;const g=require("../mapColumnToPath"),x=require("../compileValueExpression"),$=require("../normalizeLiteral");function f(e,t){var n;if(!t||e.pattern.type!=="Literal")return{};const o=(0,$.literalNodeValue)(e.pattern);if(typeof o!="string")return{};const i="^"+o.replace(/[.*+?^${}()|[\]\\]/g,r=>"\\"+r).replace(/%/g,".*").replace(/_/g,".")+"$";if(e.value.type==="ColumnRef"){const r=e.value,l=(0,g.mapColumnToPath)(r,t);if(l&&!(!((n=r.traversal)===null||n===void 0)&&n.length)){const s={$regex:i,$options:"i"};return e.not?{[l]:{$not:s}}:{[l]:s}}const p=(0,x.compileValueExpression)(r,t);if(p==null)return{};const c={$regexMatch:{input:p,regex:i,options:"i"}};return e.not?{$expr:{$not:[c]}}:{$expr:c}}const u=(0,x.compileValueExpression)(e.value,t);if(u==null)return{};const a={$regexMatch:{input:u,regex:i,options:"i"}};return e.not?{$expr:{$not:[a]}}:{$expr:a}}
